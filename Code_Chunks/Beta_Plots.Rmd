---
title: "Plotting_Betas"
author: "Anton Holm"
date: '2020-04-16'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

```{r}
Completed_df <- Completed_df %>% mutate(`Random Effects` = replace(`Random Effects`, `Random Effects` == "HIGH", "High"))
save(Completed_df, file = "Completed_df.Rda")
load("Completed_df.Rda")

betas <- Completed_df %>% filter(Method != "True") %>% mutate(Slope_Perc = ifelse(Slope < 0.01, "1%", "5%"))

tobit_betas_high <- betas %>% 
  filter(Method == "Tobit") %>% 
  select(-(Method)) %>% 
  filter(Std == 1.4) %>% 
  filter(`Random Effects` == "High")


museum_betas_high <- betas %>% 
  filter(Method == "Museum") %>% 
  select(-(Method)) %>% 
  filter(Std == 1.4) %>% 
  filter(`Random Effects` == "High")

betas_spread_high <- tobit_betas_high %>% 
  mutate(Museum_Beta = museum_betas_high$Beta)


Plot_High_Variance <- betas_spread_high %>% ggplot(aes(x=Beta, y=Museum_Beta)) +
  facet_grid(Slope_Perc ~ `Limit fraction`) +
  geom_point() + 
   geom_hline(data = data.frame(Slope_Perc="1%", y=log(1.01)), mapping=aes(yintercept=y)) +
   geom_vline(data = data.frame(Slope_Perc="1%", x=log(1.01)), mapping=aes(xintercept=x)) +
  geom_hline(data = data.frame(Slope_Perc="5%", y=log(1.05)), mapping=aes(yintercept=y))+
   geom_vline(data = data.frame(Slope_Perc="5%", x=log(1.05)), mapping=aes(xintercept=x)) +
  labs(caption = "Figure 2: Plotting the estimated slopes for the Museum model and Tobit model against eachother
having the variance of both error terms set to high.")

save(Plot_High_Variance, file = "Plot_High_Variance.Rda")



tobit_betas_low <- betas %>% 
  filter(Method == "Tobit") %>% 
  select(-(Method)) %>% 
  filter(Std == 0.05) %>% 
  filter(`Random Effects` == "Low")


museum_betas_low <- betas %>% 
  filter(Method == "Museum") %>% 
  select(-(Method)) %>% 
  filter(Std == 0.05) %>% 
  filter(`Random Effects` == "Low")

betas_spread_low <- tobit_betas_low %>% 
  mutate(Museum_Beta = museum_betas_low$Beta)


Plot_low_Variance <- betas_spread_low %>% ggplot(aes(x=Beta, y=Museum_Beta)) +
  facet_grid(Slope_Perc ~ `Limit fraction`) +
  geom_point() + 
   geom_hline(data = data.frame(Slope_Perc="1%", y=log(1.01)), mapping=aes(yintercept=y)) +
   geom_vline(data = data.frame(Slope_Perc="1%", x=log(1.01)), mapping=aes(xintercept=x)) +
  geom_hline(data = data.frame(Slope_Perc="5%", y=log(1.05)), mapping=aes(yintercept=y))+
   geom_vline(data = data.frame(Slope_Perc="5%", x=log(1.05)), mapping=aes(xintercept=x)) +
  labs(caption = "Figure 3: Plotting the estimated slopes for the Museum model and Tobit model against eachother
having the variance of both error terms set to low.")

save(Plot_low_Variance, file = "Plot_low_Variance.Rda")


Plot_low_Variance
Plot_High_Variance

```